<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Discord Sign-in</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;padding:24px}
    .muted{opacity:.75}
  </style>
</head>
<body>
  <h2>Discord Sign-in</h2>
  <div class="muted">Completing login and redirecting back to the plannerâ€¦</div>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const code = params.get("code");
      const state = params.get("state");

      // If Discord returned an error, just bounce back to planner with the same params.
      const returnToRaw = sessionStorage.getItem("discord_return_to") || "/planner/";
      const returnTo = new URL(returnToRaw, window.location.origin);

      if (code) returnTo.searchParams.set("code", code);
      if (state) returnTo.searchParams.set("state", state);

      // Keep the user on the same origin and hand off to app.js on the planner page
      window.location.replace(returnTo.toString());
    })();
  </script>
</body>
</html>
